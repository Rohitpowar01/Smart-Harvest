<!-- views/customer/register.ejs -->
 <!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="icon" type="image/png" href="/assets/img/logo.png" />
  <title>Smart Harvest</title>

  <!-- CSS & Fonts -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" crossorigin="anonymous">
  <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-social/5.1.1/bootstrap-social.min.css" />
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <link href="/assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="/assets/css/nucleo-svg.css" rel="stylesheet" />
  <link rel="stylesheet" href="/assets/css/creativetim.min.css">
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>

  <script>
    function getDistrict(stateId) {
  $.post('/customer/get-district', { state_id: stateId }, function(data) {
    $('#district-list').html(data);
  });
}
  </script>
</head>

<body class="bg-white" id="top">
<%- include('../partials/navbar') %>

<section class="section section-shaped section-lg">
  <div class="shape shape-style-1 shape-primary">
    <% for (let i = 0; i < 10; i++) { %>
      <span></span>
    <% } %>
  </div>

  <div class="container">
    <div class="row">
      <div class="col-md-8 mx-auto text-center">
        <span class="badge badge-info badge-pill mb-3">Register</span>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12 mb-3">
        <div class="nav nav-tabs nav-fill bg-gradient-default">
          <a class="nav-item nav-link active font-weight-bold text-warning">User Signup</a>
        </div>

        <div class="tab-content py-3 px-3 px-sm-0 bg-gradient-inf">
          <div class="tab-pane fade show active">
            <div class="card card-body bg-gradient-warning">
              <% if (error) { %>
                <div class="alert alert-info alert-dismissible fade show text-center" role="alert">
                  <strong><%= error %></strong>
                  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
              <% } %>
              
              <form action="/customer/register" method="POST">
                <div class="form-group row">
                  <label class="col-md-3 col-form-label text-white">Customer Name *</label>
                  <div class="col-md-9">
                    <input class="form-control" type="text" name="name" required />
                  </div>
                </div>

                <div class="form-group row">
                  <label class="col-md-3 col-form-label text-white">Email Address *</label>
                  <div class="col-md-9">
                    <input class="form-control" type="email" name="email" required />
                  </div>
                </div>

                <div class="form-group row">
                  <label class="col-md-3 col-form-label text-white">Mobile No *</label>
                  <div class="col-md-9">
                    <input class="form-control" type="tel" name="mobile" pattern="[6789][0-9]{9}" required />
                  </div>
                </div>

                <div class="form-group row">
                  <label class="col-md-3 col-form-label text-white">State *</label>
                  <div class="col-md-9">
                    <select name="state" id="state" class="form-control" onchange="getDistrict(this.value);">
                      <option value="">Select State</option>
                      <% states.forEach(state => { %>
                        <option value="<%= state.StCode %>"><%= state.StateName %></option>
                      <% }); %>
                    </select>
                  </div>
                </div>

                <div class="form-group row">
                  <label class="col-md-3 col-form-label text-white">District *</label>
                  <div class="col-md-9">
                    <select name="district" id="district-list" class="form-control">
                      <option value="">Select District</option>
                    </select>
                  </div>
                </div>

                <div class="form-group row">
                  <label class="col-md-3 col-form-label text-white">Address *</label>
                  <div class="col-md-9">
                    <input class="form-control" type="text" name="address" required />
                  </div>
                </div>

                <div class="form-group row">
                  <label class="col-md-3 col-form-label text-white">Pincode *</label>
                  <div class="col-md-9">
                    <input class="form-control" type="number" name="pincode" required />
                  </div>
                </div>

                <div class="form-group row">
                  <label class="col-md-3 col-form-label text-white">Password *</label>
                  <div class="col-9">
                    <div class="input-group mb-3">
                      <div class="input-group-prepend">
                        <span class="input-group-text"><i class="fas fa-lock"></i></span>
                      </div>
                      <input name="password" type="password" id="password" class="form-control" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" required />
                      <div class="input-group-append">
                        <span class="input-group-text" onclick="togglePassword('password')">
                          <i class="fas fa-eye"></i>
                        </span>
                      </div>
                    </div>
                    <span class="text-white d-block">Use minimum 8 Characters with at least 1 number, capital letter and special character.</span>
                  </div>
                </div>

                <div class="form-group row">
                  <label class="col-md-3 col-form-label text-white">Confirm Password *</label>
                  <div class="col-9">
                    <div class="input-group mb-3">
                      <div class="input-group-prepend">
                        <span class="input-group-text"><i class="fas fa-lock"></i></span>
                      </div>
                      <input name="confirmpassword" type="password" id="confirmpassword" class="form-control" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" required />
                      <div class="input-group-append">
                        <span class="input-group-text" onclick="togglePassword('confirmpassword')">
                          <i class="fas fa-eye"></i>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="form-group row">
                  <div class="col-md-9 offset-md-3">
                    <button type="submit" class="btn btn-success btn-block">Submit</button>
                  </div>
                </div>
              </form>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<%- include('../partials/footer') %>

<script>


function togglePassword(fieldId) {
  const input = document.getElementById(fieldId);
  if (input.type === 'password') {
    input.type = 'text';
  } else {
    input.type = 'password';
  }
}
</script>
